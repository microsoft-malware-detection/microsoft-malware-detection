{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "13032688",
   "metadata": {},
   "source": [
    "# Libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "id": "5ad8df8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np \n",
    "import matplotlib.pyplot as plt\n",
    "from sklearn.decomposition import PCA\n",
    "import pickle as pk\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "id": "62037795",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.base import BaseEstimator\n",
    "from sklearn.dummy import DummyClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn import preprocessing\n",
    "label_ecoder = preprocessing.LabelEncoder()\n",
    "from sklearn.metrics import classification_report"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "cc9f5de5",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.naive_bayes import GaussianNB\n",
    "from xgboost import XGBClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "504fc1ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "class EstimatorHandler(BaseEstimator):\n",
    "    def __init__(self, estimator = DummyClassifier()):\n",
    "        self.estimator = estimator\n",
    "\n",
    "    def fit(self, X, y=None, **kwargs):\n",
    "        self.estimator.fit(X, y)\n",
    "        return self\n",
    "\n",
    "    def predict(self, X, y=None): #Will adjust depends on ROC and AUROC CURVES \n",
    "        return self.estimator.predict(X)\n",
    "\n",
    "\n",
    "    def predict_proba(self, X):\n",
    "        return self.estimator.predict_proba(X)\n",
    "\n",
    "\n",
    "    def score(self, X, y):\n",
    "        return self.estimator.score(X, y)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "c6394f07",
   "metadata": {},
   "outputs": [],
   "source": [
    "## MIGHT NEED \n",
    "class MLPipeline:\n",
    "    def __init__(self, classifier: ClassifierHandler):\n",
    "        self.classifier = classifier\n",
    "        \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "c1514c76",
   "metadata": {},
   "outputs": [],
   "source": [
    "def encode_category_columns(columns,label_ecoder,df):\n",
    "    for column in columns:\n",
    "        df[column] = label_ecoder.fit_transform(df[column])\n",
    "    return df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f0b4968",
   "metadata": {},
   "source": [
    "# DATA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "2e78d458",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Datatypes for each column\n",
    "##interim_data_types = pd.read_csv('../data/interim/interim_data_types.csv', index_col='col_name')['type'].to_dict()\n",
    "##df = pd.read_csv('../data/interim/microsoft_malware_data.csv', dtype=interim_data_types)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "a6ea2a18",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "2a9074d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "pickle_data = '../data/pickle/df.pkl'\n",
    "df.to_pickle(\"../data/pickle/df.pkl\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "8c5f26b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_pickle(pickle_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "50f6b5d0",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df.drop(columns=['HasDetections'])\n",
    "y = df['HasDetections']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "0cb0d330",
   "metadata": {},
   "outputs": [],
   "source": [
    "numeric_columns = df.select_dtypes(include=np.number).columns.tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "ad5f7e52",
   "metadata": {},
   "outputs": [],
   "source": [
    "category_columns = df.select_dtypes('category').columns.tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "31ca9def",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_numeric = X[numeric_columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "e8f92ebb",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_encoded = encode_category_columns(category_columns,label_ecoder,X)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68b8628f",
   "metadata": {},
   "source": [
    "## 1.0 PCA "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3f7c4df",
   "metadata": {},
   "source": [
    "### 1.1 PCA 1\n",
    "Numeric Columns Only"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "e473751f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#pk.dump(pca_numeric,open(\"../data/pickle/pca_numeric.pkl\",\"wb\"))\n",
    "#pk.dump(pca_numeric_encoder,open(\"../data/pickle/pca_numeric_encoder.pkl\",\"wb\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "bd2dfc92",
   "metadata": {},
   "outputs": [],
   "source": [
    "def pickle_handler():\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bb1993b2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "10eba315",
   "metadata": {},
   "outputs": [],
   "source": [
    "pca_numeric = PCA().fit(X_numeric)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "7f23fbe1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(np.cumsum(pca.explained_variance_ratio_))\n",
    "plt.xlabel('Number of components')\n",
    "plt.ylabel('Cumulative explained variance');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e295337f",
   "metadata": {},
   "source": [
    "### 1.2 PCA 2 \n",
    "Numeric + Label Encoder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "600cfa44",
   "metadata": {},
   "outputs": [],
   "source": [
    "pca_numeric_encoder = PCA().fit(X_encoded)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "4aae6fc2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(np.cumsum(pca.explained_variance_ratio_))\n",
    "plt.xlabel('Number of components')\n",
    "plt.ylabel('Cumulative explained variance');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c00da1f",
   "metadata": {},
   "source": [
    "## MODEL ENTIRE DATA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "id": "aa446afb",
   "metadata": {},
   "outputs": [],
   "source": [
    "##Name__param\n",
    "pipeline = Pipeline([\n",
    "    ('clf', EstimatorHandler()),\n",
    "])\n",
    "parameters = [\n",
    "    {\n",
    "        'clf': (EstimatorHandler()),\n",
    "    }\n",
    "    \n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "892b4b6e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Pipeline(steps=[('clf', EstimatorHandler())])"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pipeline.fit(X_encoded,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "7a26ccf7",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = pipeline.predict(X)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "0172721f",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n",
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "       False       0.00      0.00      0.00   4276661\n",
      "        True       0.50      1.00      0.67   4286833\n",
      "\n",
      "    accuracy                           0.50   8563494\n",
      "   macro avg       0.25      0.50      0.33   8563494\n",
      "weighted avg       0.25      0.50      0.33   8563494\n",
      "\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "048fe3f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "models = [\n",
    "          ('Dummy', DummyClassifier()), \n",
    "          ('LogReg', LogisticRegression()), \n",
    "          ('RF', RandomForestClassifier()),\n",
    "          ('KNN', KNeighborsClassifier()),\n",
    "          ('SVM', SVC()), \n",
    "          ('GNB', GaussianNB()),\n",
    "          ('XGB', XGBClassifier())\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a1ae1643",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n",
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n",
      "/Users/tyronsamaroo/opt/anaconda3/envs/microsoft-malware-detection/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "       False       0.00      0.00      0.00   4276661\n",
      "        True       0.50      1.00      0.67   4286833\n",
      "\n",
      "    accuracy                           0.50   8563494\n",
      "   macro avg       0.25      0.50      0.33   8563494\n",
      "weighted avg       0.25      0.50      0.33   8563494\n",
      "\n"
     ]
    }
   ],
   "source": [
    "names = []\n",
    "results = []\n",
    "model_info = []\n",
    "for name, model in models:\n",
    "    model.fit(X,y)\n",
    "    y_pred = model.predict(X)\n",
    "    res = classification_report(y,y_pred)\n",
    "    print(res)\n",
    "    names.append(name)\n",
    "    results.append(res)\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ad593bfe",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24c43aab",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "23fa4543",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
